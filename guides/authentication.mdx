# Authentication Guide

Secure authentication is crucial for protecting your Unpod account and API access. This guide covers best practices for managing authentication in your application.

## API Keys

### Generating API Keys

1. Log in to your [Unpod Dashboard](https://app.unpod.dev)
2. Navigate to **Settings** > **API Keys**
3. Click **Generate New API Key**
4. Give your key a descriptive name (e.g., "Production Server")
5. Select the appropriate permissions (scopes)
6. Click **Generate** and securely store the key

### Key Security

- ðŸ”’ **Never commit API keys** to version control
- ðŸ”‘ Use environment variables or secret management services
- ðŸ”„ Rotate keys regularly (every 90 days recommended)
- ðŸš« Revoke compromised keys immediately

## Environment Variables

### Recommended Structure

```env
# .env file
UNPOD_API_KEY=sk_live_1234567890abcdef
UNPOD_ENVIRONMENT=production  # or 'sandbox'
```

### Loading Environment Variables

#### Node.js

```javascript
// Load environment variables from .env file
import 'dotenv/config';
import { Unpod } from '@unpod/sdk';

const unpod = new Unpod({
  apiKey: process.env.UNPOD_API_KEY,
  environment: process.env.UNPOD_ENVIRONMENT || 'production'
});
```

#### Python

```python
# Load environment variables from .env file
from dotenv import load_dotenv
import os
from unpod import Unpod

load_dotenv()

unpod = Unpod(
    api_key=os.getenv('UNPOD_API_KEY'),
    environment=os.getenv('UNPOD_ENVIRONMENT', 'production')
)
```

## Webhook Authentication

### Verifying Webhook Signatures

Unpod signs all webhook requests with a secret key. Always verify the signature to ensure the request is from Unpod.

#### Node.js Example

```javascript
import crypto from 'crypto';

export function verifyWebhook(signature, payload, secret) {
  const hmac = crypto.createHmac('sha256', secret);
  const expectedSignature = hmac.update(JSON.stringify(payload)).digest('hex');
  return crypto.timingSafeEqual(
    Buffer.from(signature),
    Buffer.from(expectedSignature)
  );
}

// In your webhook handler
app.post('/webhook', express.json(), (req, res) => {
  const signature = req.headers['x-unpod-signature'];
  const payload = req.body;
  
  if (!verifyWebhook(signature, payload, process.env.UNPOD_WEBHOOK_SECRET)) {
    return res.status(401).send('Invalid signature');
  }
  
  // Process the webhook
  // ...
});
```

## IP Allowlisting

For additional security, you can restrict API access to specific IP addresses:

1. Go to **Settings** > **Security**
2. Add your server's IP addresses to the allowlist
3. Save changes

## Rate Limiting

Authentication endpoints are rate-limited to prevent abuse:

- 100 requests per minute per IP address
- 10,000 requests per day per IP address

## Best Practices

1. **Use Different Keys for Different Environments**
   - Separate keys for development, staging, and production
   - Use environment variables to manage different configurations

2. **Implement Key Rotation**
   - Rotate API keys every 90 days
   - Update all services using the old key before revoking it

3. **Monitor Key Usage**
   - Set up alerts for unusual activity
   - Review access logs regularly

4. **Secure Your Account**
   - Enable two-factor authentication (2FA)
   - Use strong, unique passwords
   - Regularly review active sessions

## Troubleshooting

### Common Issues

- **401 Unauthorized**: Invalid or missing API key
- **403 Forbidden**: Insufficient permissions
- **429 Too Many Requests**: Rate limit exceeded

### Getting Help

If you're having trouble with authentication, contact our support team at support@unpod.dev.
